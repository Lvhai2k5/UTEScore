<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title th:text="${pageTitle}">ğŸ“œ Lá»‹ch sá»­ Ä‘áº·t sÃ¢n | UTEScore</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- âœ… Bootstrap & Icons -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
	rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
html, body {
	height: 100%;
	margin: 0;
	font-family: 'Segoe UI', Tahoma, sans-serif;
	background: linear-gradient(180deg, #f8fafc, #e2e8f0);
	overflow-x: hidden;
}
.main-content {
  background: #f8fafc;
  padding-top: 90px;      /* chá»«a khoáº£ng trá»‘ng cho header cá»‘ Ä‘á»‹nh */
  padding-bottom: 100px;  /* trÃ¡nh footer che ná»™i dung cuá»‘i */
  min-height: calc(100vh - 120px);
  overflow: visible;
  position: relative;     /* âœ… Ä‘á»ƒ footer theo luá»“ng bÃ¬nh thÆ°á»ng */
}

.history-wrapper {
	background: #fff;
	border-radius: 16px;
	box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
	max-width: 1150px;
	margin: auto;
	padding: 30px;
	animation: fadeIn 0.5s ease;
}

keyframes fadeIn {from { opacity:0;
	transform: translateY(10px);
}

to {
	opacity: 1;
	transform: translateY(0);
}

}
h3.title {
	font-weight: 700;
	color: #1e293b;
	text-align: center;
	margin-bottom: 25px;
}

.filter-box {
	background: #f1f5f9;
	border-radius: 12px;
	padding: 20px;
	margin-bottom: 25px;
}

.table thead th {
	background: linear-gradient(90deg, #16a34a, #3b82f6);
	color: white;
	text-align: center;
	font-weight: 600;
}

.table td {
	text-align: center;
	vertical-align: middle;
	color: #374151;
	font-size: 15px;
}

.btn-view, .btn-danger, .btn-warning, .btn-info {
	border: none;
	font-weight: 500;
	transition: 0.2s;
}

.btn-view {
	background: linear-gradient(90deg, #3b82f6, #2563eb);
	color: #fff;
}

.btn-warning {
	color: #000;
}

.btn-view:hover, .btn-danger:hover, .btn-warning:hover, .btn-info:hover
	{
	transform: translateY(-2px);
	opacity: 0.9;
}

.chart-section {
	margin-top: 40px;
	background: #f9fafb;
	border-radius: 12px;
	padding: 25px;
}

canvas {
	background: #fff;
	border-radius: 8px;
	padding: 10px;
	margin-top: 15px;
}

.countdown {
	font-weight: 600;
	display: inline-block;
	margin-bottom: 6px;
}

.modal-content {
	border-radius: 12px;
}
</style>
</head>

<body>
	<!-- HEADER -->
	<div th:replace="~{fragments/header :: header}"></div>
	<!-- MAIN CONTENT -->
	<div class="main-content">
		<div class="container">
			<div class="history-wrapper">
				<h3 class="title">ğŸ“œ Lá»‹ch sá»­ Ä‘áº·t sÃ¢n</h3>

				<!-- Bá»™ lá»c -->
				<form method="get" action="#" class="row g-3 filter-box">
					<div class="col-md-3">
						<label class="form-label fw-semibold">Tá»« ngÃ y:</label> <input
							type="date" name="fromDate" th:value="${fromDate}"
							class="form-control">
					</div>
					<div class="col-md-3">
						<label class="form-label fw-semibold">Äáº¿n ngÃ y:</label> <input
							type="date" name="toDate" th:value="${toDate}"
							class="form-control">
					</div>
					<div class="col-md-3 align-self-end">
						<button type="submit" class="btn btn-primary w-100">
							<i class="bi bi-search"></i> Lá»c
						</button>
					</div>
					<div class="col-md-3 align-self-end">
						<a
							th:href="@{/customer/export-history(fromDate=${fromDate},toDate=${toDate})}"
							class="btn btn-success w-100"> <i
							class="bi bi-file-earmark-excel"></i> Xuáº¥t Excel
						</a>
					</div>
				</form>

				<!-- Danh sÃ¡ch Ä‘Æ¡n -->
				<div class="table-responsive">
					<table class="table table-bordered table-hover align-middle">
						<thead>
							<tr>
								<th>MÃ£ Ä‘Æ¡n</th>
								<th>TÃªn sÃ¢n</th>
								<th>NgÃ y thuÃª</th>
								<th>Khung giá»</th>
								<th>Tá»•ng tiá»n</th>
								<th>Tráº¡ng thÃ¡i</th>
								<th>HÃ nh Ä‘á»™ng</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="dto : ${bookingsView}">
								<td th:text="${dto.thueSan.maDonDat}"></td>
								<td th:text="${dto.thueSan.sanBong.tenSan}"></td>
								<td
									th:text="${#temporals.format(dto.thueSan.ngayThue,'dd/MM/yyyy')}"></td>
								<td
									th:text="${dto.thueSan.khungGioBatDau+' - '+dto.thueSan.khungGioKetThuc}"></td>
								<td
									th:text="${#numbers.formatDecimal(dto.thueSan.tongTien,0,'COMMA',0,'POINT')} + ' VNÄ'"></td>

								<!-- âœ… Tráº¡ng thÃ¡i -->
								<td><span th:text="${dto.trangThai}"></span></td>

								<!-- âœ… HÃ nh Ä‘á»™ng -->
								<td>
									<!-- â³ ChÆ°a thanh toÃ¡n -->
									<div
										th:if="${dto.trangThai == 'â³ ChÆ°a thanh toÃ¡n (Ä‘ang giá»¯ chá»—)'}">
										<div th:if="${dto.countdownSeconds > 0}">
											<span class="badge bg-warning-subtle text-warning countdown"
												th:data-seconds="${dto.countdownSeconds}"> â³ CÃ²n <span
												class="time-text">--:--</span> Ä‘á»ƒ thanh toÃ¡n cá»c
											</span>
											<div class="mt-2">
												<button class="btn btn-danger btn-sm cancel-btn me-1"
													th:data-madon="${dto.thueSan.maDonDat}">âŒ Há»§y</button>
												<button class="btn btn-warning btn-sm pay-deposit-btn"
													th:data-madon="${dto.thueSan.maDonDat}">ğŸ’³ Thanh
													toÃ¡n cá»c</button>
											</div>
										</div>
										<div th:if="${dto.countdownSeconds <= 0}">
											<span class="text-muted fst-italic small"> â° Háº¿t thá»i
												gian giá»¯ chá»— â€” vui lÃ²ng Ä‘áº·t láº¡i. </span>
										</div>
									</div> <!-- ğŸ’µ ÄÃ£ Ä‘áº·t cá»c -->
									<div th:if="${dto.trangThai == 'ğŸ’µ ÄÃ£ Ä‘áº·t cá»c (30%)'}">
										<button class="btn btn-info btn-sm view-invoice-btn me-1"
											th:data-madon="${dto.thueSan.maDonDat}">ğŸ§¾ Xem hÃ³a
											Ä‘Æ¡n</button>
										<button class="btn btn-danger btn-sm refund-btn"
											th:data-madon="${dto.thueSan.maDonDat}">ğŸ’¸ HoÃ n Ä‘Æ¡n</button>
									</div>
									<div
										th:if="${dto.trangThai == 'ğŸ’µ ÄÃ£ Ä‘áº·t cá»c â€” khÃ¡ch khÃ´ng Ä‘áº¿n'}">
										<button class="btn btn-view btn-sm view-invoice-btn"
											th:data-madon="${dto.thueSan.maDonDat}">ğŸ‘ï¸ Xem hÃ³a
											Ä‘Æ¡n</button>
									</div> <!-- ğŸ’° ÄÃ£ thanh toÃ¡n -->
									<div th:if="${dto.trangThai == 'ğŸ’° ÄÃ£ thanh toÃ¡n (Ä‘á»§ tiá»n)'}">
										<button class="btn btn-success btn-sm view-invoice-btn"
											th:data-madon="${dto.thueSan.maDonDat}">ğŸ§¾ Xem hÃ³a
											Ä‘Æ¡n</button>
									</div> <!-- âœ… HoÃ n táº¥t -->
									<div th:if="${dto.trangThai == 'âœ… HoÃ n táº¥t (Ä‘Ã£ check-in)'}">
										<button class="btn btn-success btn-sm view-invoice-btn"
											th:data-madon="${dto.thueSan.maDonDat}">ğŸ§¾ Xem hÃ³a
											Ä‘Æ¡n</button>
									</div> <!-- ğŸ’¸ HoÃ n Ä‘Æ¡n thÃ nh cÃ´ng -->
									<div th:if="${dto.trangThai == 'ğŸ’¸ HoÃ n Ä‘Æ¡n (Ä‘Ã£ hoÃ n tiá»n)'}">
										<span class="badge bg-info-subtle text-info p-2">ğŸ’¸
											HoÃ n Ä‘Æ¡n thÃ nh cÃ´ng</span>
										<button class="btn btn-view btn-sm mt-1 view-invoice-btn"
											th:data-madon="${dto.thueSan.maDonDat}">ğŸ‘ï¸ Xem hÃ³a
											Ä‘Æ¡n</button>
									</div> <!-- â³ Äang chá» xá»­ lÃ½ hoÃ n Ä‘Æ¡n -->
									<div th:if="${dto.trangThai == 'â³ Äang chá» xá»­ lÃ½ hoÃ n Ä‘Æ¡n'}">
										<button class="btn btn-info btn-sm view-invoice-btn"
											th:data-madon="${dto.thueSan.maDonDat}">ğŸ‘ï¸ Xem hÃ³a
											Ä‘Æ¡n</button>
									</div>
								</td>
							</tr>

							<tr th:if="${#lists.isEmpty(bookingsView)}">
								<td colspan="7" class="text-center text-muted">KhÃ´ng cÃ³ dá»¯
									liá»‡u.</td>
							</tr>
						</tbody>
					</table>
				</div>

				<!-- PhÃ¢n trang -->
				<div
					class="d-flex justify-content-between align-items-center mt-3 flex-wrap gap-2">
					<div class="text-muted small fw-medium">
						Trang <span th:text="${bookings.number + 1}">1</span> / <span
							th:text="${bookings.totalPages}">1</span> â€” Tá»•ng <span
							th:text="${bookings.totalElements}">0</span> Ä‘Æ¡n
					</div>
					<nav aria-label="Page navigation">
						<ul class="pagination pagination-sm mb-0 shadow-sm rounded-pill">
							<li class="page-item"
								th:classappend="${bookings.first}? 'disabled'"><a
								class="page-link"
								th:href="@{/customer/history(page=${bookings.number},fromDate=${fromDate},toDate=${toDate})}">
									<i class="bi bi-chevron-left"></i>
							</a></li>
							<li th:each="i : ${#numbers.sequence(1, bookings.totalPages)}"
								class="page-item"
								th:classappend="${i == bookings.number + 1}? 'active'"><a
								class="page-link fw-semibold"
								th:href="@{/customer/history(page=${i},fromDate=${fromDate},toDate=${toDate})}"
								th:text="${i}">1</a></li>
							<li class="page-item"
								th:classappend="${bookings.last}? 'disabled'"><a
								class="page-link"
								th:href="@{/customer/history(page=${bookings.number + 2},fromDate=${fromDate},toDate=${toDate})}">
									<i class="bi bi-chevron-right"></i>
							</a></li>
						</ul>
					</nav>
				</div>

				<!-- Biá»ƒu Ä‘á»“ -->
				<div class="chart-section mt-5">
					<h5 class="fw-bold text-primary mb-3">ğŸ“Š Sá»‘ lÆ°á»£ng Ä‘Æ¡n theo
						thÃ¡ng</h5>
					<canvas id="chartStatus" height="130"></canvas>

					<h5 class="fw-bold text-success mt-5 mb-3">ğŸ’³ Lá»‹ch sá»­ giao
						dá»‹ch 3 thÃ¡ng gáº§n nháº¥t</h5>
					<canvas id="chart3Months" height="130"></canvas>
				</div>
			</div>
		</div>
	</div>

	<!-- FOOTER -->
	<div th:replace="fragments/footer :: footer"></div>


	<!-- ğŸ§¾ TEMPLATE HÃ“A ÄÆ N CHI TIáº¾T -->
	<div id="invoice-template" style="display: none;">
		<div class="invoice-pro p-4 shadow-sm rounded bg-white">
			<style>
.invoice-pro {
	font-family: 'Segoe UI', Tahoma, sans-serif;
	color: #111827;
	max-width: 700px;
	margin: auto;
	border: 1px solid #e5e7eb;
}

.invoice-pro p, .invoice-pro td, .invoice-pro th {
	text-align: left !important;
}

.invoice-header {
	text-align: center;
	border-bottom: 3px solid #16a34a;
	padding-bottom: 8px;
	margin-bottom: 10px;
}

.invoice-header h4 {
	color: #15803d;
	font-weight: 700;
	margin-bottom: 2px;
}

.invoice-header small {
	color: #6b7280;
}

.invoice-brand {
	display: flex;
	justify-content: space-between;
	align-items: center;
}

.invoice-brand img {
	height: 50px;
}

.invoice-brand .info {
	text-align: right;
	font-size: 14px;
	color: #374151;
}

.table th {
	background: #16a34a;
	color: white;
	text-align: center;
}

.table td {
	text-align: center;
	vertical-align: middle;
}

.total-line {
	font-weight: 600;
	background: #f1f5f9;
	border-radius: 8px;
	padding: 10px 15px;
	display: flex;
	justify-content: space-between;
}

.signatures {
	margin-top: 25px;
	display: flex;
	justify-content: space-between;
	text-align: center;
}

.sign-box {
	width: 45%;
	border-top: 1px solid #94a3b8;
	padding-top: 5px;
	font-size: 14px;
	color: #334155;
}
</style>

			<div class="invoice-brand mb-3">
				<div class="logo">
					<img th:src="@{/uploads/Logo.jpg}" alt="UTEScore Logo">
				</div>
				<div class="info">
					<strong>UTEScore Football</strong><br> Sá»‘ 1 VÃµ VÄƒn NgÃ¢n,
					Thá»§ Äá»©c, TP.HCM<br> Hotline: 0344 969 875<br> Email:
					support@utescore.vn
				</div>
			</div>

			<div class="invoice-header">
				<h4>HÃ“A ÄÆ N THANH TOÃN Dá»ŠCH Vá»¤</h4>
				<small id="inv-date"></small>
			</div>

			<div class="invoice-info mb-3">
				<p>
					<b>MÃ£ Ä‘Æ¡n:</b> <span id="inv-madon"></span>
				</p>
				<p>
					<b>KhÃ¡ch hÃ ng:</b> <span id="inv-khach"></span>
				</p>
				<p>
					<b>SÃ¢n bÃ³ng:</b> <span id="inv-san"></span>
				</p>
				<p>
					<b>NgÃ y thuÃª:</b> <span id="inv-ngay"></span>
				</p>
				<p>
					<b>Khung giá»:</b> <span id="inv-gio"></span>
				</p>
			</div>

			<h6
				class="fw-bold text-success mb-2 border-bottom border-success pb-1">ğŸ’³
				Danh sÃ¡ch giao dá»‹ch</h6>
			<table class="table table-bordered table-sm mb-3">
				<thead>
					<tr>
						<th>Loáº¡i thanh toÃ¡n</th>
						<th>PhÆ°Æ¡ng thá»©c</th>
						<th>Sá»‘ tiá»n</th>
						<th>Tráº¡ng thÃ¡i</th>
						<th>NgÃ y</th>
					</tr>
				</thead>
				<tbody id="inv-payments">
					<tr>
						<td colspan="5" class="text-center text-muted">Äang táº£i...</td>
					</tr>
				</tbody>
			</table>

			<div class="total-line">
				<span>Tá»•ng tiá»n sÃ¢n:</span> <span id="inv-tong"></span>
			</div>

			<div class="signatures">
				<div class="sign-box">
					<b>Thu ngÃ¢n</b><br>(KÃ½, ghi rÃµ há» tÃªn)
				</div>
				<div class="sign-box">
					<b>KhÃ¡ch hÃ ng</b><br>(KÃ½, ghi rÃµ há» tÃªn)
				</div>
			</div>

			<p class="text-center text-muted mt-3 small fst-italic">Â© 2025
				UTEScore â€” ÄÃ£ bao gá»“m thuáº¿ VAT</p>
		</div>
	</div>

	<!-- SCRIPT -->
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script th:inline="javascript">
  /*<![CDATA[*/
  document.addEventListener("DOMContentLoaded", () => {
    // âŒ Há»§y Ä‘Æ¡n
    document.querySelectorAll(".cancel-btn").forEach(btn=>{
      btn.addEventListener("click",()=>{
        Swal.fire({
          title:"Báº¡n cÃ³ cháº¯c muá»‘n há»§y Ä‘Æ¡n nÃ y?",
          icon:"warning",showCancelButton:true,
          confirmButtonText:"CÃ³, há»§y ngay",cancelButtonText:"KhÃ´ng"
        }).then(r=>{if(r.isConfirmed)
          window.location.href=`/customer/cancel-booking?maDonDat=${btn.dataset.madon}`;});
      });
    });

    // ğŸ’³ Thanh toÃ¡n cá»c
    document.querySelectorAll(".pay-deposit-btn").forEach(btn=>{
      btn.addEventListener("click",()=>window.location.href=`/customer/payment/deposit?maDonDat=${btn.dataset.madon}`);});
 // ğŸ’¸ HoÃ n Ä‘Æ¡n 
    document.querySelectorAll(".refund-btn").forEach(btn => {
  btn.addEventListener("click", async () => {
    const maDonDat = btn.dataset.madon;

    const { isConfirmed, value } = await Swal.fire({
      title: "ğŸ§¾ Gá»­i yÃªu cáº§u hoÃ n Ä‘Æ¡n",
      html: `
        <div class="text-start">
          <p class="fw-semibold text-danger mb-2">
            âš ï¸ Vui lÃ²ng kiá»ƒm tra ká»¹ thÃ´ng tin trÆ°á»›c khi gá»­i.<br>
            Sau khi gá»­i yÃªu cáº§u, báº¡n <b>khÃ´ng thá»ƒ hoÃ n tÃ¡c</b>.
          </p>

          <div class="mb-2">
            <label class="fw-semibold">NgÃ¢n hÃ ng:</label>
            <input type="text" id="bank" class="form-control" placeholder="VD: Vietcombank, MB Bank...">
          </div>

          <div class="mb-2">
            <label class="fw-semibold">Sá»‘ tÃ i khoáº£n:</label>
            <input type="text" id="account" class="form-control" placeholder="Nháº­p sá»‘ tÃ i khoáº£n cá»§a báº¡n">
          </div>

          <div class="mb-2">
            <label class="fw-semibold">LÃ½ do hoÃ n Ä‘Æ¡n:</label>
            <input type="text" id="reason" class="form-control" placeholder="VD: Báº­n viá»‡c Ä‘á»™t xuáº¥t, Ä‘á»•i lá»‹ch...">
          </div>

          <div class="mb-2">
            <label class="fw-semibold">MÃ´ táº£ thÃªm (ghi chÃº):</label>
            <textarea id="note" class="form-control" rows="3" placeholder="Ghi rÃµ thÃªm thÃ´ng tin náº¿u cáº§n..."></textarea>
          </div>
        </div>
      `,
      showCancelButton: true,
      confirmButtonText: "Gá»­i yÃªu cáº§u hoÃ n Ä‘Æ¡n",
      cancelButtonText: "Há»§y",
      focusConfirm: false,
      preConfirm: () => {
        const bank = document.getElementById("bank").value.trim();
        const account = document.getElementById("account").value.trim();
        const reason = document.getElementById("reason").value.trim();
        const note = document.getElementById("note").value.trim();

        if (!bank || !account || !reason) {
          Swal.showValidationMessage("Vui lÃ²ng nháº­p Ä‘áº§y Ä‘á»§ ngÃ¢n hÃ ng, sá»‘ tÃ i khoáº£n vÃ  lÃ½ do hoÃ n Ä‘Æ¡n!");
          return false;
        }

        return { bank, account, reason, note };
      }
    });

    if (!isConfirmed) return;

    try {
      const res = await fetch(`/customer/refund-request?maDonDat=${maDonDat}`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          nganHang: value.bank,
          soTaiKhoan: value.account,
          lyDoHoan: value.reason,
          ghiChu: value.note
        })
      });
      const data = await res.json();

      if (data.success) {
        Swal.fire({
          icon: "success",
          title: "âœ… ÄÃ£ gá»­i yÃªu cáº§u hoÃ n Ä‘Æ¡n",
          text: data.message,
          confirmButtonText: "ÄÃ³ng"
        }).then(() => location.reload());
      } else {
        Swal.fire("Lá»—i âš ï¸", data.message, "error");
      }
    } catch (err) {
      Swal.fire("Lá»—i há»‡ thá»‘ng", err.message, "error");
    }
  });
});


    // ğŸ§¾ Xem hÃ³a Ä‘Æ¡n
    // ğŸ§¾ Xem hÃ³a Ä‘Æ¡n popup hiá»‡n Ä‘áº¡i
document.querySelectorAll(".view-invoice-btn").forEach(btn=>{
  btn.addEventListener("click", async ()=>{
    const id = btn.dataset.madon;
    const res = await fetch(`/customer/api/invoice?maDonDat=${id}`);
    const data = await res.json();

    if(data.error){
      Swal.fire("Lá»—i!", data.error, "error");
      return;
    }

    const tpl = document.querySelector("#invoice-template").innerHTML;
    const temp = document.createElement("div");
    temp.innerHTML = tpl;

    // GÃ¡n dá»¯ liá»‡u Ä‘á»™ng
    temp.querySelector("#inv-date").textContent = new Date(data.ngayThue).toLocaleString("vi-VN");
    temp.querySelector("#inv-madon").textContent = data.maDonDat;
    temp.querySelector("#inv-khach").textContent = data.khachHang;
    temp.querySelector("#inv-san").textContent = data.sanBong;
    temp.querySelector("#inv-ngay").textContent = new Date(data.ngayThue).toLocaleDateString("vi-VN");
    temp.querySelector("#inv-gio").textContent = data.khungGio;
    temp.querySelector("#inv-tong").textContent = new Intl.NumberFormat("vi-VN").format(data.tongTien) + " VNÄ";

    const tbody = temp.querySelector("#inv-payments");
    tbody.innerHTML = data.thanhToans.length
      ? data.thanhToans.map(p => `
        <tr>
          <td>${p.loai}</td>
          <td>${p.pttt}</td>
          <td>${new Intl.NumberFormat("vi-VN").format(p.soTien)} VNÄ</td>
          <td>${p.trangThai === 'ThÃ nh cÃ´ng'
                ? '<span class="badge bg-success">ThÃ nh cÃ´ng</span>'
                : '<span class="badge bg-warning text-dark">'+p.trangThai+'</span>'}</td>
          <td>${new Date(p.ngay).toLocaleString("vi-VN")}</td>
        </tr>`).join("")
      : `<tr><td colspan="5" class="text-center text-muted">ChÆ°a cÃ³ giao dá»‹ch nÃ o.</td></tr>`;

    Swal.fire({
      width: 800,
      html: temp.innerHTML,
      showConfirmButton: false,
      showCloseButton: true,
      background: "#f9fafb",
      scrollbarPadding: false
    });
  });
});
    // â± Countdown
    document.querySelectorAll(".countdown").forEach(el=>{
      let seconds=parseInt(el.dataset.seconds||"0",10);
      const span=el.querySelector(".time-text");
      if(!seconds||seconds<=0){el.remove();return;}
      function tick(){
        if(seconds<=0){el.textContent="â° Háº¿t thá»i gian giá»¯ chá»—!";el.classList.add("text-muted");return;}
        const m=Math.floor(seconds/60),s=seconds%60;
        span.textContent=`${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
        if(seconds<30)el.style.color="#dc2626";else if(seconds<60)el.style.color="#f97316";else el.style.color="#16a34a";
        seconds--;setTimeout(tick,1000);}
      tick();
    });

    // ğŸ“Š Biá»ƒu Ä‘á»“
    const labelsStatus=/*[[${labelsStatus}]]*/[];
    const successData=/*[[${successData}]]*/[];
    const cancelData=/*[[${cancelData}]]*/[];
    const refundData=/*[[${refundData}]]*/[];
    new Chart(document.getElementById("chartStatus"),{
      type:"bar",
      data:{labels:labelsStatus,datasets:[
        {label:"ThÃ nh cÃ´ng/ÄÃ£ Ä‘Ã¡",data:successData,backgroundColor:"#16a34a"},
        {label:"ÄÃ£ há»§y",data:cancelData,backgroundColor:"#ef4444"},
        {label:"HoÃ n tiá»n",data:refundData,backgroundColor:"#60a5fa"}]},
      options:{responsive:true,scales:{y:{beginAtZero:true}}}
    });

    const labels3=/*[[${labels3}]]*/[];
    const data3=/*[[${data3}]]*/[];
    new Chart(document.getElementById("chart3Months"),{
      type:"line",
      data:{labels:labels3,datasets:[{label:"Sá»‘ tiá»n giao dá»‹ch (VNÄ)",data:data3,borderColor:"#2563eb",backgroundColor:"#93c5fd",fill:true,tension:0.3}]},
      options:{responsive:true,scales:{y:{beginAtZero:true}}}
    });
  });
  /*]]>*/
  </script>
</body>
</html>
