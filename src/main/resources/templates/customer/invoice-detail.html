<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title th:text="'H√≥a ƒë∆°n #' + ${thueSan.maDonDat} + ' | UTEScore'">üßæ H√≥a ƒë∆°n | UTEScore</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- ‚úÖ Bootstrap & Custom CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet" th:href="@{/css/customer-home.css}">

  <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: linear-gradient(180deg, #f8fafc, #e2e8f0);
      min-height: 100vh;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }

    .invoice-container {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      width: 850px;
      margin: 90px auto;
      padding: 40px 60px;
      animation: fadeIn 0.6s ease;
    }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px);} to { opacity: 1; transform: translateY(0);} }

    .invoice-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      border-bottom: 2px solid #e5e7eb;
      padding-bottom: 15px;
    }

    .invoice-header h2 {
      font-weight: 700;
      color: #1e3a8a;
    }

    .invoice-logo img {
      width: 80px;
      border-radius: 12px;
    }

    .invoice-info p {
      margin: 4px 0;
      font-size: 15px;
      color: #374151;
    }

    .table th {
      background: linear-gradient(90deg, #16a34a, #3b82f6);
      color: white;
      font-weight: 600;
      text-align: center;
    }

    .table td {
      text-align: center;
      vertical-align: middle;
      color: #334155;
    }

    .total-section {
      text-align: right;
      margin-top: 25px;
    }

    .total-section h5 {
      font-weight: 700;
      color: #111827;
    }

    .badge-status {
      font-size: 14px;
      padding: 6px 14px;
      border-radius: 20px;
      font-weight: 600;
    }

    .badge-success { background: #bbf7d0; color: #166534; }
    .badge-danger { background: #fecaca; color: #991b1b; }
    .badge-warning { background: #fde68a; color: #92400e; }
    .badge-secondary { background: #e5e7eb; color: #374151; }

    .btn-gradient {
      background: linear-gradient(90deg, #16a34a, #3b82f6);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px 22px;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .btn-gradient:hover { opacity: 0.9; transform: translateY(-2px); }
  </style>
</head>

<body>

  <!-- ‚úÖ HEADER -->
  <div th:replace="fragments/header :: header"></div>

  <!-- ‚úÖ H√ìA ƒê∆†N -->
  <div class="invoice-container">

    <div class="invoice-header">
      <h2>üßæ H√≥a ƒë∆°n thanh to√°n</h2>
      <div class="invoice-logo">
        <img th:src="@{/images/logo.png}" alt="UTEScore Logo">
      </div>
    </div>

    <div class="invoice-info">
      <p><strong>M√£ ƒë∆°n:</strong> <span th:text="${thueSan.maDonDat}"></span></p>
      <p><strong>Kh√°ch h√†ng:</strong> <span th:text="${thueSan.khachHang.hoTen}"></span></p>
      <p><strong>Ng√†y thu√™:</strong> <span th:text="${#temporals.format(thueSan.ngayThue,'dd/MM/yyyy')}"></span></p>
      <p><strong>Gi·ªù thi ƒë·∫•u:</strong> <span th:text="${thueSan.khungGioBatDau + ' - ' + thueSan.khungGioKetThuc}"></span></p>
      <p><strong>S√¢n:</strong> <span th:text="${thueSan.sanBong.tenSan}"></span></p>
      <p><strong>Tr·∫°ng th√°i:</strong>
        <span th:classappend="
          ${thueSan.ghiChu != null && thueSan.ghiChu.contains('ƒê√£ ƒë·∫∑t c·ªçc')} ? 'badge-success' :
          ${thueSan.ghiChu != null && thueSan.ghiChu.contains('h·ªßy')} ? 'badge-danger' :
          ${thueSan.ghiChu != null && thueSan.ghiChu.contains('Ch·ªù')} ? 'badge-warning' : 'badge-secondary'"
          class="badge-status" th:text="${thueSan.ghiChu}">ƒê√£ ƒë·∫∑t c·ªçc</span>
      </p>
    </div>

    <table class="table table-bordered">
      <thead>
        <tr>
          <th>#</th>
          <th>Ng√†y thanh to√°n</th>
          <th>Ph∆∞∆°ng th·ª©c</th>
          <th>Lo·∫°i</th>
          <th>S·ªë ti·ªÅn</th>
          <th>Tr·∫°ng th√°i</th>
        </tr>
      </thead>
      <tbody>
        <tr th:each="p, i : ${thueSan.thanhToans}">
          <td th:text="${i.index + 1}"></td>
          <td th:text="${#temporals.format(p.ngayThanhToan,'dd/MM/yyyy HH:mm')}"></td>
          <td th:text="${p.phuongThuc}"></td>
          <td th:text="${p.loaiThanhToan}"></td>
          <td th:text="${#numbers.formatInteger(p.soTienNhan,0,'POINT')} + ' ƒë'"></td>
          <td th:text="${p.trangThaiThanhToan}"></td>
        </tr>
        <tr th:if="${#lists.isEmpty(thueSan.thanhToans)}">
          <td colspan="6" class="text-muted">Ch∆∞a c√≥ giao d·ªãch thanh to√°n n√†o.</td>
        </tr>
      </tbody>
    </table>

    <div class="total-section">
      <h5>T·ªïng ti·ªÅn: <span th:text="${#numbers.formatInteger(thueSan.tongTien,0,'POINT')} + ' ƒë'"></span></h5>
      <h5>ƒê√£ thanh to√°n: 
        <span th:text="${thueSan.tienCocBatBuoc != null ? #numbers.formatInteger(thueSan.tienCocBatBuoc,0,'POINT') + ' ƒë' : '0 ƒë'}"></span>
      </h5>
    </div>

    <div class="text-center mt-4">
      <a th:href="@{'/customer/invoice/pdf'(maDonDat=${thueSan.maDonDat})}" class="btn-gradient me-2">üìÑ Xu·∫•t PDF</a>
      <a th:href="@{'/customer/invoice/excel'(maDonDat=${thueSan.maDonDat})}" class="btn-gradient me-2">üìä Xu·∫•t Excel</a>
      <a th:href="@{/customer/history}" class="btn btn-outline-secondary">‚¨ÖÔ∏è Quay l·∫°i l·ªãch s·ª≠</a>
    </div>

    <div class="text-center mt-4">
      <img src="https://developers.vnpay.vn/resources/images/vnpay_qr.png" alt="VNPay" width="100">
      <p class="text-muted mt-2" style="font-size:13px;">C·∫£m ∆°n qu√Ω kh√°ch ƒë√£ s·ª≠ d·ª•ng d·ªãch v·ª• c·ªßa UTEScore ‚öΩ</p>
    </div>
  </div>

  <!-- ‚úÖ FOOTER -->
  <div th:replace="fragments/footer :: footer"></div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
