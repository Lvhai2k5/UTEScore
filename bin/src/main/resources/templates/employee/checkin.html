<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UTEScore â€“ Quáº£n lÃ½ Check-in (Realtime)</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>

<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Inter', sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: #1e293b;
    display: flex;
    height: 100vh;
    overflow: hidden;
  }

  /* SIDEBAR */
  .sidebar {
    width: 270px;
    background: linear-gradient(180deg, #1e293b, #0f172a);
    color: white;
    display: flex;
    flex-direction: column;
    box-shadow: 4px 0 24px rgba(0,0,0,0.3);
    overflow-y: auto;
  }
  .logo-section { padding: 24px 16px; border-bottom: 1px solid rgba(255,255,255,0.1); }
  .logo { font-size: 26px; font-weight: 700; text-align: center; background: linear-gradient(135deg,#667eea,#a78bfa); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
  .staff-info { text-align:center; margin-top:16px; background:rgba(255,255,255,0.05); border-radius:12px; padding:12px; }
  .staff-avatar { width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);margin:0 auto 10px;display:flex;align-items:center;justify-content:center;font-size:26px; }
  .staff-name{font-weight:600;font-size:15px;}
  .staff-role{font-size:13px;color:#94a3b8;}
  .menu{padding:16px;flex:1;}
  .menu-title{font-size:13px;font-weight:600;color:#94a3b8;margin:8px 0;text-transform:uppercase;letter-spacing:0.5px;}
  .menu-link{display:flex;align-items:center;gap:10px;color:white;text-decoration:none;background:rgba(255,255,255,0.05);padding:12px 14px;border-radius:10px;margin-bottom:6px;font-size:15px;transition:all 0.3s ease;}
  .menu-link:hover{background:rgba(255,255,255,0.1);transform:translateX(4px);}
  .menu-link.active{background:linear-gradient(135deg,rgba(102,126,234,0.4),rgba(118,75,162,0.4));}
  .menu-icon{font-size:18px;width:26px;text-align:center;}

  /* CONTENT */
  .content {
    flex: 1;
    background: #f8fafc;
    margin: 24px;
    border-radius: 24px;
    padding: 32px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.1);
    overflow-y: auto;
  }
  header { display:flex;justify-content:space-between;align-items:center;margin-bottom:32px; }
  header h2 {
    font-size:32px;font-weight:700;
    background:linear-gradient(135deg,#1e293b,#475569);
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  }
  .btn { background:linear-gradient(135deg,#667eea,#764ba2);color:white;border:none;padding:10px 18px;border-radius:10px;cursor:pointer;font-weight:600;transition:all .3s; }
  .btn:hover{transform:translateY(-2px);}
  .btn-secondary{background:white;color:#1e293b;border:1px solid #e2e8f0;padding:10px 18px;border-radius:10px;font-weight:500;cursor:pointer;}
  .toolbar{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:20px;}
  .input,.select{padding:10px 14px;border-radius:8px;border:1px solid #cbd5e1;font-size:15px;}
  .card{
    background:white;
    border-radius:16px;
    box-shadow:0 4px 12px rgba(0,0,0,0.06);
    padding:24px;
  }
  .table{
    width:100%;
    border-collapse:collapse;
    margin-top:12px;
  }
  .table th,.table td{
    padding:12px 14px;
    border-bottom:1px solid #e2e8f0;
    text-align:left;
  }
  .table th{background:#f1f5f9;color:#1e293b;font-weight:600;}
  .table tr:hover{background:#f9fafb;}
  .footer-note{text-align:center;margin-top:16px;color:#64748b;font-size:13px;}
</style>
</head>
<body>
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="logo-section">
    <div class="logo">UTEScore</div>
    <div class="staff-info">
      <div class="staff-avatar">âš™ï¸</div>
      <div class="staff-name" th:text="${nhanVienDangNhap?.hoTen}">NhÃ¢n viÃªn</div>
      <div class="staff-role">Bá»™ pháº­n sÃ¢n bÃ³ng</div>
    </div>
  </div>

    <div class="menu">
      <p class="menu-title">ğŸŸï¸ Quáº£n lÃ½ sÃ¢n</p>
      <a href="/employee/booking" class="menu-link active"><span class="menu-icon">ğŸ“‹</span>ÄÆ¡n Ä‘áº·t sÃ¢n</a>
        <a href="/employee/checkin" class="menu-link"><span class="menu-icon">ğŸ«</span>Check-in khÃ¡ch</a>
        <a href="/employee/payment" class="menu-link"><span class="menu-icon">ğŸ’°</span>Thanh toÃ¡n</a>
        <a href="/employee/refund" class="menu-link"><span class="menu-icon">ğŸ‘¥</span>HoÃ n tiá»n</a>
        <a href="/employee/schedule" class="menu-link"><span class="menu-icon">ğŸ“…</span>Lá»‹ch sÃ¢n</a>

      <p class="menu-title">ğŸ“¢ BÃ¡o cÃ¡o & ThÃ´ng tin</p>
      <a href="/employee/incidents" class="menu-link"><span class="menu-icon">âš ï¸</span>Sá»± cá»‘ / Ghi chÃº</a>
      <a href="/employee/report" class="menu-link"><span class="menu-icon">ğŸ“Š</span>Thá»‘ng kÃª cÃ´ng viá»‡c</a>

      <p class="menu-title">âš™ï¸ CÃ¡ nhÃ¢n</p>
      <a href="/employee/profile" class="menu-link"><span class="menu-icon">ğŸ‘¤</span>ThÃ´ng tin cÃ¡ nhÃ¢n</a>
      <a href="/logout" class="menu-link"><span class="menu-icon">ğŸšª</span>ÄÄƒng xuáº¥t</a>
    </div>
  </aside>

  <!-- MAIN CONTENT -->
  <section class="content">
    <header>
      <h2>Danh sÃ¡ch Check-In</h2>
      <div>
        <button class="btn-secondary" onclick="location.href='/employee'">Trang chá»§</button>
      </div>
    </header>

    <div class="toolbar">
      <form th:action="@{/employee/checkin/search}" method="get" style="display:flex;gap:8px;">
        <input class="input" name="keyword" placeholder="ğŸ” TÃ¬m theo tÃªn khÃ¡ch / mÃ£ Ä‘Æ¡n ..." style="max-width:320px">
        <button class="btn" type="submit">TÃ¬m kiáº¿m</button>
      </form>
    </div>

    <div class="card">
      <table class="table">
        <thead>
          <tr>
            <th>MÃ£ Ä‘Æ¡n</th><th>KhÃ¡ch hÃ ng</th><th>SÃ¢n</th><th>NgÃ y thuÃª</th><th>Khung giá»</th><th>Thao tÃ¡c</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="don : ${donDatSans}">
            <td th:text="'#D' + ${don.maDonDat}">#001</td>
            <td th:text="${don.khachHang.hoTen}">Nguyá»…n VÄƒn A</td>
            <td th:text="${don.sanBong.tenSan}">SÃ¢n 1</td>
            <td th:text="${#temporals.format(don.ngayThue, 'dd/MM/yyyy HH:mm')}">25/10/2025 18:00</td>
            <td th:text="${don.khungGioBatDau + ' - ' + don.khungGioKetThuc}">18:00â€“19:30</td>
            <td>
              <a th:href="@{'/employee/checkin/generate/' + ${don.maDonDat}}" class="btn">ğŸ“± Hiá»ƒn thá»‹ QR</a>
            </td>
          </tr>
        </tbody>
      </table>
      <p class="footer-note" th:if="${#lists.isEmpty(donDatSans)}">KhÃ´ng cÃ³ Ä‘Æ¡n nÃ o cáº§n check-in.</p>
    </div>

    <p class="footer-note">Â© 2025 UTEScore â€¢ Employee UI</p>
  </section>

<script>
  // âœ… Káº¿t ná»‘i WebSocket realtime
  const socket = new SockJS('/ws-checkin');
  const stompClient = Stomp.over(socket);
  stompClient.connect({}, () => {
    console.log('âœ… ÄÃ£ káº¿t ná»‘i realtime');
    stompClient.subscribe('/topic/checkin-updates', () => {
      const note = document.createElement('div');
      note.textContent = 'ğŸ”„ Cáº­p nháº­t danh sÃ¡ch check-in...';
      note.style = 'background:#dcfce7;color:#166534;padding:10px;margin:10px 0;border-radius:8px;font-weight:500;text-align:center;';
      document.querySelector('.card').prepend(note);
      setTimeout(()=>location.reload(),1200);
    });
  });
</script>

</body>
</html>
